## Лицензирование

[Лицензирование продукта](https://ru.wikipedia.org/wiki/%D0%9B%D0%B8%D1%86%D0%B5%D0%BD%D0%B7%D0%B8%D1%8F_%D0%BD%D0%B0_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%BD%D0%BE%D0%B5_%D0%BE%D0%B1%D0%B5%D1%81%D0%BF%D0%B5%D1%87%D0%B5%D0%BD%D0%B8%D0%B5) — ещё один важный этап разработки. Каждый проект имеет некоторые цели в его использовании, распространении, доступности и т.д. И для реализации этих целей необходим некоторый инструмент, ограничивающий (или не ограничивающий) пользователей ПО. Лицензии глобально можно разделить на [проприетарные](https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%BE%D0%BF%D1%80%D0%B8%D0%B5%D1%82%D0%B0%D1%80%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%BD%D0%BE%D0%B5_%D0%BE%D0%B1%D0%B5%D1%81%D0%BF%D0%B5%D1%87%D0%B5%D0%BD%D0%B8%D0%B5) и [свободные](https://ru.wikipedia.org/wiki/%D0%A1%D0%B2%D0%BE%D0%B1%D0%BE%D0%B4%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%BD%D0%BE%D0%B5_%D0%BE%D0%B1%D0%B5%D1%81%D0%BF%D0%B5%D1%87%D0%B5%D0%BD%D0%B8%D0%B5).

 Проприетарные лицензии эксплуатируют свойство _безущербного копирования_ информации: для того, чтобы из одного _экземпляра_ программного продукта сделать два, никаких дополнительных затрат не требуется — в отличие от материальных объектов, на копирование которых потребны расходные материалы и созидательный труд рабочего (особенно в отсутствие автоматизации). Как следствие, бизнес на основе проприетарных лицензий на ПО стремится максимально монетизировать именно факт _копирования экземпляра_, так так он в идеале приносит бесконечный процент прибыли. При этом, как правило,
* _распространение_ ПО без санкций правообладателя запрещается полностью,
* количество одновременно работающих копий продукта фиксировано.
Грубо говоря, каждая работающая копия продукта требуют _покупки ещё одной лицензии_, и в эту новую покупку не входит вообще никакого ПО и другой информации, кроме увеличения числа лицензий у потребителя. 

Бизнес на основе торговли копиями также влечёт за собой особенности _разработки_ ПО — она становится _закрытой_. Дабы пресечь непрямое несанкционированное распространение, полностью запрещается доступ к исходным текстам программ, это, в свою очередь, накладывает ограничения на состав и мобильность команды разработчиков и т. д. Основные принципы такого бизнеса, а также некоторые (отчасти сомнительные) моральные его аспекты изложены Биллом Гейтсом в его знаменитом «[Открытом письме любителям](https://ru.wikipedia.org/wiki/%D0%9E%D1%82%D0%BA%D1%80%D1%8B%D1%82%D0%BE%D0%B5_%D0%BF%D0%B8%D1%81%D1%8C%D0%BC%D0%BE_%D0%BB%D1%8E%D0%B1%D0%B8%D1%82%D0%B5%D0%BB%D1%8F%D0%BC)».

Свобдные лицензии, напротив, используют факт безущербного копирования информации для того, чтобы как можно шире распространять программные продукты и привлекать к их разработке как можно больший круг участников. Это подразумевает _открытую_ модель разработки ПО, в которой (в идеале) исходные тексты программ не только не закрываются, а лежат на самом видном месте, да ещё и сопровождаются толковой внутренней документацией, дисциплиной оформления, принятой в сообществе, открытым диалогом в соответствующих информационных каналах и т. п.

Бизнес на основе свободного ПО технически отличается от проприетарного только отсутствием монетизации копирования. Однако это влечёт за собой изменение _целей_: такой бизнес в первую очередь старается спровоцировать пользователей _принять участие в разработке_ ПО — протестировать, исправить недочёт, дописать недостающую функциональность, задокументировать, сделать перевод и т. п. Для этого пользователю нужно дать чёткие права по отношению к самому продукту и его исходным текстам, таким образом любой пользователь свободного ПО автоматически становится _партнёром_ основного разработчика.

Одним из главных идеологов свободного ПО является [Ричард Столлман](https://ru.wikipedia.org/wiki/%D0%A1%D1%82%D0%BE%D0%BB%D0%BB%D0%BC%D0%B0%D0%BD%2C_%D0%A0%D0%B8%D1%87%D0%B0%D1%80%D0%B4_%D0%9C%D1%8D%D1%82%D1%82%D1%8C%D1%8E). Ему принадлежит авторство одной из самых известных свободных лицензий — [GPL](https://ru.wikipedia.org/wiki/GPL), а также самое, пожалуй, прозрачное и непротиворечиаое определение свободного ПО (в том или ином виде вошедшее в различные законодательные практики).

По Столлману, свободная лицензия предоставляет пользователю всего четыре права:

0. **Право запускать программу для любых целей**
   Пользователи могут запускать программу на любом оборудовании и для любых задач.
1. **Право изучать и изменять исходный код**
   Пользователи имеют доступ к исходному коду программы и могут изменять его, чтобы адаптировать ПО под свои нужды.
2. **Право распространять копии программы**
   Пользователи могут свободно распространять копии программы как в исходном виде, так и в измененном; как бесплатно, так и за плату.
3. **Право распространять измененные версии программы**
   Пользователи могут публиковать измененные версии программы без каких-либо санкций от разработчика.

Данные свободы гарантируют полный контроль над ПО при его использовании и преобразовании. Различные аспекты местного законодательства (например, неотторжимое авторство или «право на имя») имеют более высокий приоритет, но не конфликтуют с этим определением.

Большой класс свободных лицензий — т. н. «[разрешительные](https://ru.wikipedia.org/wiki/%D0%A0%D0%B0%D0%B7%D1%80%D0%B5%D1%88%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F_%D0%BB%D0%B8%D1%86%D0%B5%D0%BD%D0%B7%D0%B8%D1%8F_%D1%81%D0%B2%D0%BE%D0%B1%D0%BE%D0%B4%D0%BD%D0%BE%D0%B3%D0%BE_%D0%9F%D0%9E) (или _пермиссивные_) лицензии воспроизводят эти четыре права с различными модификациями. Наиболее популярные разрешительные лицензии —  [BSD](https://ru.wikipedia.org/wiki/%D0%9B%D0%B8%D1%86%D0%B5%D0%BD%D0%B7%D0%B8%D0%B8_BSD), [MIT](https://ru.wikipedia.org/wiki/%D0%9B%D0%B8%D1%86%D0%B5%D0%BD%D0%B7%D0%B8%D1%8F_MIT) и [Creative Commons](https://ru.wikipedia.org/wiki/Creative_Commons) в варианте «Attribution» (CC-BY).

Бизнес-применение разрешительных лицензий имеет важную особенность: пользователь имеет право _изменять политику лицензирования_. Практически все производители  проприетарного ПО используют свободные компоненты — у них есть право распространять производный продукт под закрытой лицензией. К сожалению, культура закрытой разработки по многим причинам не позволяет оставлять получившиеся компоненты (что более важно — их эффективные модификации) открытыми.

Стоит заметить, что в современном мире постоянно увеличивается количество ПО и его компонентов под разрешительными лицензиями, причём изрядную долю этого роста обеспечивают именно крупные корпорации с проприетарной моделью разработки — Google, Microsoft, Facebook и т. п. Разрешительные лицензии играют здесь роль катализатора для _законного обмена технологиями_. Скажем, в Facebook разработана высокоэффективная библиотека кеширования ссылок (чем бы она ни являлась☺). Корпорация заинтересована в _распространении_ этой библиотеки (выгода очевидна: стороннее тестирование, в том числе в принципиально других условиях, доработка, кроссплатформенная совместимость и т. д.), а бизнеса на её продаже не планирует. Если наложить на такой продукт проприетарную лицензию, часть предполагаемых пользователей от неё откажутся из-за высокой стоимости владения, другая часть — из-за лавинообразного роста обязательств в стиле «кто кому сколько за что должен». Выход — минималистичная свободна лицензия.

_Запрет_ на изменение политики лицензирования никак не влияет на свойство самого исходного текста ПО, но ограничивает пользователя в плане выбора лицензии, под которой они будет распространять производный продукт. Такое добавление к свободной лицензии носит название «[копилефт](%D0%9A%D0%BE%D0%BF%D0%B8%D0%BB%D0%B5%D1%84%D1%82)», и его автор — тот же Ричард Столлман.

[«Копилефтные»](https://ru.wikipedia.org/wiki/%D0%9A%D0%BE%D0%BF%D0%B8%D0%BB%D0%B5%D1%84%D1%82) лицензии содержат пятое правило: «В лицензии производного ПО в обязательном порядке требуется наличие, как минимум, описанных пяти пунктов текущей лицензии». При таких условиях пользователь встаёт перед выбором: либо не распространять обновлённое ПО, либо как минимум по запросу предоставлять исходники.

Наиболее популярно семейство копилефтных лицензий [GPL](https://ru.wikipedia.org/wiki/GNU_General_Public_License) с вариациями, а также [Creative Commons](https://ru.wikipedia.org/wiki/Creative_Commons) в варианте «Sharing Requirements» (CC-BY-SA).

Стоит заметить, что «некоммерческие лицензии», как, например, Creative Commons с суффиксом NC, не являются cвободными, так как противоречат двум последним пунктам.

Выбор лицензии зависит от задач и целей проекта. Прочитать о том, как правильно выбрать лицензию для своего продукта, можно по [рекомендациям GitHub](https://docs.github.com/ru/repositories/managing-your-repositorys-settings-and-features/customizing-your-repository/licensing-a-repository); можно ещё [здесь](https://opensource.guide/legal/#which-open-source-license-is-appropriate-for-my-project) и [здесь](https://writefreesoftware.org/). Изучать лицензии и их формальные свойства подробнее стоит [на сайте «System Package Data Exchange»](https://spdx.org/licenses/). Также для выбора лицензии существуют специальные сервисы ([choosealicense](https://choosealicense.com/), [Creative Commons](https://creativecommons.org/chooser/)).

## Множественная сборка пакетов

При работе с проектами со свободными лицензиями нередко встречаются случаи, когда из одного и того же набора исходных текстов необходимо собирать несколько пакетов. Частым примером такого случая является [сборка библиотек](https://www.altlinux.org/SampleSpecs/library), а именно обычной их версии и devel-версии. Ведение отдельных репозиториев для сборки разных пакетов в таком случае — нерациональное решение. Ещё одним примером является как раз проблема лицензирования: в проекте могут присутствовать материалы разных лицензий (например, для исходных текстов и для документации). По правилам _ALT Linux Team_ допустима сборка пакета со множеством лицензий для исходников при условии упоминания всх лицензий в соответствующей директиве spec-файла. Однако сборка разных пакетов считается более правильной.

Рассмотрим небольшой пример, в котором на основе одних исходников соберём два пакета. Возьмём два простых shell-сценария и разобьём их на два пакета из одного исходного spec-файла.

`@user`: `double/first-part`

```shell
echo "This is the first pkg from this spec"
```

`@user`: `double/second-part`

```shell
echo "This is the second pkg from this spec"
```

`@user`: `double/.gear/rules`

```
spec: .gear/double.spec
copy: .
```

Для сборки двух или более пакетов их одного комплекта исходников в spec-файле необходимо указать 3 дополнительных директивы:
 + Директива `%package <suffix>` описывает основные метаданные пакета, название которого соответствует формату `%name-suffix`. В рамках данной директивы обязательно должны быть описаны директивы Summary, License и Group. Сюда же прописываются Requires и BuildArch при их необходимости
 + Директива `%description <suffix>` даёт описание создаваемого дополнительного пакета
 + Директива `%files <suffix>` описывает входящие в дополнительный пакет файлы.

`@user`: `double/.gear/double.spec`

```specfile
Name: double
Version: 1.0
Release: alt1

Summary: First pkg from single spec
License: GPLv3+
Group: Development/Other

%package second
Summary: Second pkg from single spec
License: GPLv3+
Group: Development/Other

Source0: first-part.sh
Source1: second-part.sh

%description
This pkg was built from single spec. This is the first pkg

%description second
This pkg was built from single spec. This is the second pkg

%install
install -D %SOURCE0 %buildroot%_bindir/%name
install -D %SOURCE1 %buildroot%_bindir/%name-second

%files
%_bindir/%name

%files second
%_bindir/%name-second

%changelog
* Mon Aug 18 2025 UsamG1t <usamg1t@altlinux.org> 1.0-alt1
- Initial Build
```

При сборке из одного spec-файла собираются один пакет с исходным кодом и несколько установочных пакетов согласно описанному именованию:

`@user`
```console
[user@VM double]$ gear-hsh --lazy
<...>
Wrote: /usr/src/RPM/SRPMS/double-1.0-alt1.src.rpm (w2.lzdio)
Wrote: /usr/src/RPM/RPMS/x86_64/double-1.0-alt1.x86_64.rpm (w2.lzdio)
Wrote: /usr/src/RPM/RPMS/x86_64/double-second-1.0-alt1.x86_64.rpm (w2.lzdio)
0.69user 0.91system 0:06.76elapsed 23%CPU (0avgtext+0avgdata 9240maxresident)k
0inputs+336outputs (0major+92880minor)pagefaults 0swaps
[user@VM double]$ cp ~/hasher/repo/x86_64/RPMS.hasher/double-1.0-alt1.x86_64.rpm ~/has
her/chroot/.in/
[user@VM double]$ cp ~/hasher/repo/x86_64/RPMS.hasher/double-second-1.0-alt1.x86_64.rp
m ~/hasher/chroot/.in/
```

Каждый из пакетов содержит свой список файлов:

`@rooter`
```console
[root@localhost .in]# rpm -i double-1.0-alt1.x86_64.rpm
<13>Aug 18 01:19:29 rpm: double-1.0-alt1 1755479842 installed
[root@localhost .in]# which double
/usr/bin/double
[root@localhost .in]# double
This is the first pkg from this spec

[root@localhost .in]# rpm  -i double-second-1.0-alt1.x86_64.rpm
<13>Aug 18 01:19:47 rpm: double-second-1.0-alt1 1755479842 installed
[root@localhost .in]# which double-second
/usr/bin/double-second
[root@localhost .in]# double-second
This is the second pkg from this spec
[root@localhost .in]#
```
