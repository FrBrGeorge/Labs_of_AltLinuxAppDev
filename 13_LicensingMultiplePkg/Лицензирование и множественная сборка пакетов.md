## Лицензирование

Лицензирование продукта — ещё один важный этап разработки. Каждый проект имеет некоторые цели в его использовании, распространении, доступности и т.д. И для реализации этих целей необходим некоторый инструмент, ограничивающий (или не ограничивающий) пользователей ПО.

Лицензии глобально можно разделить на **проприетарные** и **некоммерческие**. Проприетарные лицензии ограничивают использование, модификацию и распространение ПО. Обычно такие лицензии подразумевают доступ по подписке или продажу одноразового установочного пакета и аналогичные коммерческие способы.

Более обширным является класс некоммерческих лицензий, которые, в свою очередь, разделяются на **разрешительные** и **«копилефтные»**.

Все некоммерческие (свободные) лицензии базируются на четырёх свободах свободного программного обеспечения (при этом ПО не обязано быть бесплатным; оно лишь не должно ограничивать пользователей):

1. **Свобода запускать программу для любых целей**
   Пользователи могут запускать программу на любом оборудовании и для любых задач.
2. **Свобода изучать и изменять исходный код**
   Пользователи имеют доступ к исходному коду программы и могут изменять его, чтобы адаптировать ПО под свои нужды.
3. **Свобода распространять копии программы**
   Пользователи могут свободно распространять копии программы как в исходном виде, так и в измененном; как бесплатно, так и за плату.
4. **Свобода распространять измененные версии программы**
   Пользователи могут публиковать измененные версии программы без каких-либо санкций от разработчика.

Данные свободы гарантируют полный контроль над ПО при его использовании и преобразовании.

Разрешительные лицензии, такие как [MIT](https://ru.wikipedia.org/wiki/%D0%9B%D0%B8%D1%86%D0%B5%D0%BD%D0%B7%D0%B8%D1%8F_MIT), [BSD](https://ru.wikipedia.org/wiki/%D0%9B%D0%B8%D1%86%D0%B5%D0%BD%D0%B7%D0%B8%D0%B8_BSD), основываются только на этих четырёх тезисах, что позволяет, например, для изменённого ПО поменять лицензию, сделав её, например, коммерческой. Для сохранения свободности ПО появились [«копилефтные»](https://ru.wikipedia.org/wiki/%D0%9A%D0%BE%D0%BF%D0%B8%D0%BB%D0%B5%D1%84%D1%82) лицензии, которые в обязательном порядке содержат и пятое правило: «В лицензии производного ПО в обязательном порядке требуется наличие, как минимум, описанных пяти пунктов текущей лицензии». При таких условиях пользователь встаёт перед выбором: либо не распространять обновлённое ПО, либо как минимум по запросу предоставлять исходники.

Данные лицензии обеспечивают свободность всего ПО, источником которого выступают лицензированные исходники. Одним из самых популярных семейств копилефтных лицензий выступает семейство [GPL](https://ru.wikipedia.org/wiki/GNU_General_Public_License), лицензия которого была разработана в рамках проекта про разработке СПО [GNU](https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82_GNU).

Выбор лицензии зависит от задач и целей проекта. Прочитать о том, как правильно выбрать лицензию для своего продукта, а также изучить лицензии подробнее можно [здесь](https://gist.github.com/nicolasdao/a7adda51f2f185e8d2700e1573d8a633). Также для выбора лицензии существуют специальные сервисы ([choosealicense](https://choosealicense.com/), [Creative Commons](https://creativecommons.org/chooser/)).

## Множественная сборка пакетов

При работе с проектами со свободными лицензиями нередко встречаются случаи, когда из одного и того же набора исходных текстов необходимо собирать несколько пакетов. Частым примером такого случая является [сборка библиотек](https://www.altlinux.org/SampleSpecs/library), а именно обычной их версии и devel-версии. Ведение отдельных репозиториев для сборки разных пакетов в таком случае — нерациональное решение. Ещё одним примером является как раз проблема лицензирования: в проекте могут присутствовать материалы разных лицензий (например, для исходных текстов и для документации). По правилам _ALT Linux Team_ допустима сборка пакета со множеством лицензий для исходников при условии упоминания всх лицензий в соответствующей директиве spec-файла. Однако сборка разных пакетов считается более правильной.

Рассмотрим небольшой пример, в котором на основе одних исходников соберём два пакета. Возьмём два простых shell-сценария и разобьём их на два пакета из одного исходного spec-файла.

`@user`: `double/first-part`

```shell
echo "This is the first pkg from this spec"
```

`@user`: `double/second-part`

```shell
echo "This is the second pkg from this spec"
```

`@user`: `double/.gear/rules`

```
spec: .gear/double.spec
copy: .
```

Для сборки двух или более пакетов их одного комплекта исходников в spec-файле необходимо указать 3 дополнительных директивы:
 + Директива `%package <suffix>` описывает основные метаданные пакета, название которого соответствует формату `%name-suffix`. В рамках данной директивы обязательно должны быть описаны директивы Summary, License и Group. Сюда же прописываются Requires и BuildArch при их необходимости
 + Директива `%description <suffix>` даёт описание создаваемого дополнительного пакета
 + Директива `%files <suffix>` описывает входящие в дополнительный пакет файлы.

`@user`: `double/.gear/double.spec`

```specfile
Name: double
Version: 1.0
Release: alt1

Summary: First pkg from single spec
License: GPLv3+
Group: Development/Other

%package second
Summary: Second pkg from single spec
License: GPLv3+
Group: Development/Other

Source0: first-part.sh
Source1: second-part.sh

%description
This pkg was built from single spec. This is the first pkg

%description second
This pkg was built from single spec. This is the second pkg

%install
install -D %SOURCE0 %buildroot%_bindir/%name
install -D %SOURCE1 %buildroot%_bindir/%name-second

%files
%_bindir/%name

%files second
%_bindir/%name-second

%changelog
* Mon Aug 18 2025 UsamG1t <usamg1t@altlinux.org> 1.0-alt1
- Initial Build
```

При сборке из одного spec-файла собираются один пакет с исходным кодом и несколько установочных пакетов согласно описанному именованию:

`@user`
```console
[user@VM double]$ gear-hsh --lazy
<...>
Wrote: /usr/src/RPM/SRPMS/double-1.0-alt1.src.rpm (w2.lzdio)
Wrote: /usr/src/RPM/RPMS/x86_64/double-1.0-alt1.x86_64.rpm (w2.lzdio)
Wrote: /usr/src/RPM/RPMS/x86_64/double-second-1.0-alt1.x86_64.rpm (w2.lzdio)
0.69user 0.91system 0:06.76elapsed 23%CPU (0avgtext+0avgdata 9240maxresident)k
0inputs+336outputs (0major+92880minor)pagefaults 0swaps
[user@VM double]$ cp ~/hasher/repo/x86_64/RPMS.hasher/double-1.0-alt1.x86_64.rpm ~/has
her/chroot/.in/
[user@VM double]$ cp ~/hasher/repo/x86_64/RPMS.hasher/double-second-1.0-alt1.x86_64.rp
m ~/hasher/chroot/.in/
```

Каждый из пакетов содержит свой список файлов:

`@rooter`
```console
[root@localhost .in]# rpm -i double-1.0-alt1.x86_64.rpm
<13>Aug 18 01:19:29 rpm: double-1.0-alt1 1755479842 installed
[root@localhost .in]# which double
/usr/bin/double
[root@localhost .in]# double
This is the first pkg from this spec

[root@localhost .in]# rpm  -i double-second-1.0-alt1.x86_64.rpm
<13>Aug 18 01:19:47 rpm: double-second-1.0-alt1 1755479842 installed
[root@localhost .in]# which double-second
/usr/bin/double-second
[root@localhost .in]# double-second
This is the second pkg from this spec
[root@localhost .in]#
```