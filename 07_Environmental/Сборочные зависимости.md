
`@user`: `autoenv-pkg/src/prog.c`

```c
#include <ncurses.h>
#include <unistd.h>
#include <error.h>
#include "config.h"

#ifndef DX
#define DX 3
#endif

int main(void) {
        WINDOW *win;
        int c = 0;

        if (!isatty(0))
                error(1, 0, "Not a terminal");
        initscr();
        noecho();
        cbreak();
        printw("%s (%s)", PACKAGE_STRING, PACKAGE_BUGREPORT);
        refresh();

        win = newwin(LINES-2*DX, COLS-2*DX, DX, DX);
#ifdef KEYPAD
        keypad(win, TRUE);
#else
        keypad(win, FALSE);
#endif
        scrollok (win, TRUE);
        do {
                wprintw(win, "  Key: %d, Name: %s\n", c, keyname(c));
                box(win, 0, 0);
                wrefresh(win);
        } while((c = wgetch(win)) != 27);

        endwin();
	return 0;
}
```

 + autoscan
`@user`: `autoenv-pkg/configure.scan`

```console
#                                               -*- Autoconf -*-
# Process this file with autoconf to produce a configure script.

AC_PREREQ([2.72])
AC_INIT([FULL-PACKAGE-NAME], [VERSION], [BUG-REPORT-ADDRESS])
AC_CONFIG_SRCDIR([src/prog.c])
AC_CONFIG_HEADERS([config.h])

# Checks for programs.
AC_PROG_CC

# Checks for libraries.

# Checks for header files.
AC_CHECK_HEADERS([unistd.h])

# Checks for typedefs, structures, and compiler characteristics.

# Checks for library functions.
AC_FUNC_ERROR_AT_LINE

AC_OUTPUT
```

`@user`: `autoenv-pkg/configure.ac

```console
#                                               -*- Autoconf -*-
# Process this file with autoconf to produce a configure script.


AC_INIT([autoenv-pkg], [1.0], [UsamG1t])
AC_CONFIG_SRCDIR([src/prog.c])
AM_INIT_AUTOMAKE([foreign subdir-objects])
AC_CONFIG_HEADERS([config.h])

# Checks for programs.
AC_PROG_CC

# Checks for libraries.
AC_CHECK_LIB([ncurses],[initscr],[],[AC_MSG_ERROR([Curses is needed])])

# Checks for header files.
AC_CHECK_HEADERS([unistd.h])
AC_CHECK_HEADERS([ncurses.h])

# Optional clues
AC_ARG_ENABLE([keypad],
   AS_HELP_STRING([--enable-keypad], [Enable input ESC-sequences recognition]),
   AC_DEFINE(KEYPAD,[],[ESC-sequences recognition])
 )

AC_ARG_ENABLE([frame],
   AS_HELP_STRING([--enable-frame=width], [Define frame width]),
   AC_DEFINE_UNQUOTED(DX,[$enable_frame],[Frame width])
 )

# Checks for typedefs, structures, and compiler characteristics.

# Checks for library functions.
AC_FUNC_ERROR_AT_LINE

AC_CONFIG_FILES([Makefile])
AC_OUTPUT
```

 + Описание вставок

 + autoheader

`@user`: `autoenv-pkg/config.h.in`

```sh
/* config.h.in.  Generated from configure.ac by autoheader.  */

/* Frame width */
#undef DX

/* Define to 1 if you have the <inttypes.h> header file. */
#undef HAVE_INTTYPES_H

/* Define to 1 if you have the 'ncurses' library (-lncurses). */
#undef HAVE_LIBNCURSES

/* Define to 1 if you have the <ncurses.h> header file. */
#undef HAVE_NCURSES_H

/* Define to 1 if you have the <stdint.h> header file. */
#undef HAVE_STDINT_H

/* Define to 1 if you have the <stdio.h> header file. */
#undef HAVE_STDIO_H

/* Define to 1 if you have the <stdlib.h> header file. */
#undef HAVE_STDLIB_H

/* Define to 1 if you have the <strings.h> header file. */
#undef HAVE_STRINGS_H

/* Define to 1 if you have the <string.h> header file. */
#undef HAVE_STRING_H

/* Define to 1 if you have the <sys/stat.h> header file. */
#undef HAVE_SYS_STAT_H

/* Define to 1 if you have the <sys/types.h> header file. */
#undef HAVE_SYS_TYPES_H

/* Define to 1 if you have the <unistd.h> header file. */
#undef HAVE_UNISTD_H

/* ESC-sequences recognition */
#undef KEYPAD

/* Define to the address where bug reports for this package should be sent. */
#undef PACKAGE_BUGREPORT

/* Define to the full name of this package. */
#undef PACKAGE_NAME

/* Define to the full name and version of this package. */
#undef PACKAGE_STRING

/* Define to the one symbol short name of this package. */
#undef PACKAGE_TARNAME

/* Define to the home page for this package. */
#undef PACKAGE_URL

/* Define to the version of this package. */
#undef PACKAGE_VERSION

/* Define to 1 if all of the C89 standard headers exist (not just the ones
  required in a freestanding environment). This macro is provided for
  backward compatibility; new code need not use it. */
#undef STDC_HEADERS
```

 + aclocal + automake --add-missing

 `@user`: `autoenv-pkg/Makefile.am

```make
CFLAGS = -Wall -O0 -g

bin_PROGRAMS=autoenv

autoenv_SOURCES=src/prog.c

TESTS=isterm.sh

isterm.sh:
       echo 'test "`./autoenv < /dev/null 2>&1`" = "./autoenv: Not a terminal"' > $@
       chmod +x $@

gitclean:
       git clean -df
```

 + Описание команд

 + configure c параметрами

 `@user`: `autoenv-pkg/config.h`

```sh
/* config.h.  Generated from config.h.in by configure.  */
/* config.h.in.  Generated from configure.ac by autoheader.  */

/* Frame width */
#define DX 20

/* Define to 1 if you have the <inttypes.h> header file. */
#define HAVE_INTTYPES_H 1

/* Define to 1 if you have the 'ncurses' library (-lncurses). */
#define HAVE_LIBNCURSES 1

/* Define to 1 if you have the <ncurses.h> header file. */
#define HAVE_NCURSES_H 1

/* Define to 1 if you have the <stdint.h> header file. */
#define HAVE_STDINT_H 1

/* Define to 1 if you have the <stdio.h> header file. */
#define HAVE_STDIO_H 1

/* Define to 1 if you have the <stdlib.h> header file. */
#define HAVE_STDLIB_H 1

/* Define to 1 if you have the <strings.h> header file. */
#define HAVE_STRINGS_H 1

/* Define to 1 if you have the <string.h> header file. */
#define HAVE_STRING_H 1

/* Define to 1 if you have the <sys/stat.h> header file. */
#define HAVE_SYS_STAT_H 1

/* Define to 1 if you have the <sys/types.h> header file. */
#define HAVE_SYS_TYPES_H 1

/* Define to 1 if you have the <unistd.h> header file. */
#define HAVE_UNISTD_H 1

/* ESC-sequences recognition */
/* #undef KEYPAD */

/* Define to the address where bug reports for this package should be sent. */
#define PACKAGE_BUGREPORT "UsamG1t"

/* Define to the full name of this package. */
#define PACKAGE_NAME "autoenv-pkg"

/* Define to the full name and version of this package. */
#define PACKAGE_STRING "autoenv-pkg 1.0"

/* Define to the one symbol short name of this package. */
#define PACKAGE_TARNAME "autoenv-pkg"

/* Define to the home page for this package. */
#define PACKAGE_URL ""

/* Define to the version of this package. */
#define PACKAGE_VERSION "1.0"

/* Define to 1 if all of the C89 standard headers exist (not just the ones
  required in a freestanding environment). This macro is provided for
  backward compatibility; new code need not use it. */
#define STDC_HEADERS 1
```

 `@user`: `autoenv-pkg/autoenv-pkg.spec

```spec
Name: autoenv-pkg
Version: 1.0
Release: alt1

Summary: Test pkg with autotool

License: GPLv3+
Group: Development/Other

Source0: %name-%version.tar.gz
BuildRequires: libncurses-devel


%description
This is a small testing package, builded by autotools

%prep
%setup

%build
%autoreconf
%configure
%make_build

%install
install -D autoenv %buildroot%_bindir/autoenv

%check
make check

%files
%_bindir/*

%changelog
* Mon Jul 21 2025 UsamG1t <usamg1t@altlinux.org> 1.0-alt1
- Initial build
```